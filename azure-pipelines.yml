trigger:
  branches:
    include:
      - master

pr:
  branches:
    include:
      - master

pool:
  vmImage: 'ubuntu-latest'

variables:
  - group: github  # Grupo que cont√©m github.username e github.token

stages:
  - stage: SyncToGitHub
    displayName: 'Sync Azure master to GitHub portfolio'
    jobs:
      - job: PushToGitHub
        steps:
          - checkout: self
            clean: true
            persistCredentials: true

          - script: |
              echo "üîß Configurando Git"
              git config --global user.name "Pedro Vin√≠cios"
              git config --global user.email "pedrooviniciossantos@gmail.com"

              echo "üîç Branch atual:"
              git branch

              echo "‚ûï Adicionando remoto GitHub"
              git remote add github https://${GITHUB_USERNAME}:${GITHUB_TOKEN}@github.com/PedroVinicioss/MeuDiagnostico.git

              echo "‚¨ÜÔ∏è Dando push da branch atual para o GitHub"
              git push github HEAD:main --force
            env:
              GITHUB_USERNAME: $(github.username)
              GITHUB_TOKEN: $(github.token)