# Executa ao fazer commit na branch master
trigger:
  branches:
    include:
      - master

# Executa ao abrir um Pull Request que afeta a branch master
pr:
  branches:
    include:
      - master

pool:
  vmImage: 'ubuntu-latest'

variables:
  - group: github  # Referencia o grupo de vari√°veis com username e token

stages:
  - stage: SyncToGitHub
    displayName: 'Sync Azure master to GitHub portfolio'
    jobs:
      - job: PushToGitHub
        steps:
          - checkout: self
            clean: true
            persistCredentials: true

          - script: |
              echo "üîß Configurando Git"
              git config --global user.name "Pedro Vin√≠cios"
              git config --global user.email "pedrooviniciossantos@gmail.com"

              echo "üîÅ Verificando branch atual"
              git checkout master

              echo "‚ûï Adicionando remoto GitHub"
              git remote add github https://$(GITHUB_USERNAME):$(GITHUB_TOKEN)@github.com/PedroVinicioss/MeuDiagnostico.git

              echo "‚¨ÜÔ∏è Dando push para o GitHub"
              git push github master:main --force
            env:
              GITHUB_USERNAME: $(github.username)
              GITHUB_TOKEN: $(github.token)